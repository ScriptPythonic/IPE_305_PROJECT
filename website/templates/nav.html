<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Exchange Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    {% block style %}{% endblock style %}
    <style>
        /* Custom styles for the badge */
        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e53e3e; /* Tailwind CSS red-600 */
            color: white;
            border-radius: 9999px; /* Full rounded corners */
            padding: 0.25rem 0.5rem; /* Padding for the badge */
            font-size: 0.75rem; /* Text size for the badge */
            display: none; /* Hidden by default */
        }
        .show-badge .badge {
            display: block; /* Show the badge */
        }
        .flash-alert {
            position: fixed;
            top: 60px; /* Adjust based on the height of your navbar */
            left: 0;
            width: 100%;
            z-index: 50;
            display: none;
        }
        .form-input:focus {
            border-color: #cbd5e0;
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.5);
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Navigation Bar -->
    <header class="bg-gray-800 text-white fixed w-full z-10 top-0">
        <div class="container mx-auto flex justify-between items-center px-4 py-2">
            <div class="text-2xl font-bold">StudentExchange</div>
            <nav class="hidden md:flex space-x-4 relative">
                <a href="/" class="hover:text-gray-300">Home</a>
                <a href="#" class="hover:text-gray-300">My Listings</a>
                <a href="/messages" class="hover:text-gray-300 relative">Messages
                    <span class="badge">1</span>
                </a>
                <a href="/profile" class="hover:text-gray-300">Profile</a>
            </nav>
            <div class="md:hidden">
                <button id="mobile-menu-toggle" class="text-white hover:text-gray-300 focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu (hidden by default) -->
        <div id="mobile-menu" class="md:hidden bg-gray-800">
            <a href="/" class="block py-2 px-4 text-white hover:bg-gray-700">Home</a>
            <a href="#" class="block py-2 px-4 text-white hover:bg-gray-700">My Listings</a>
            <a href="/messages" class="block py-2 px-4 text-white hover:bg-gray-700 relative">Messages
                <span class="badge">1</span>
            </a>
            <a href="/profile" class="block py-2 px-4 text-white hover:bg-gray-700">Profile</a>
        </div>
    </header>

    <!-- Flash Alert Bar -->
    <div class="flash-alert">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="bg-{{ 'red' if category == 'error' else 'green' }}-600 text-white text-center py-2 relative">
                        {{ message }}
                        <button class="absolute top-1/2 right-4 transform -translate-y-1/2 text-white hover:text-gray-300 focus:outline-none" onclick="this.parentElement.style.display='none';">
                            &times;
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    {% block content %}
    
    {% endblock content %}
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
        AOS.init({
            offset: 100, // offset (in px) from the original trigger point
            delay: 0, // delay on elements' animations, in ms
            duration: 800, // duration of the animation, in ms
            easing: 'ease-in-out', // default easing for AOS animations
        });
    </script>

    <!-- Smooth Scroll Behavior -->
    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();

                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
    <script>
        document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // Show flash messages if any
        document.addEventListener('DOMContentLoaded', function () {
            var flashAlert = document.querySelector('.flash-alert');
            if (flashAlert) {
                flashAlert.style.display = 'block';
            }
        });

        // Example to show the badge if there are new messages
        document.addEventListener('DOMContentLoaded', function () {
            // This condition should be based on real data (e.g., AJAX request, server-side logic)
            var hasNewMessages = true; // Example condition
            if (hasNewMessages) {
                var badgeElements = document.querySelectorAll('.badge');
                badgeElements.forEach(function (badge) {
                    badge.style.display = 'block';
                });
            }
        });
    </script>

    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto text-center">
            <p>&copy; 2024 StudentExchange. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
